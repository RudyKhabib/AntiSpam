# Проект "Репутация пользователей"
**Задача**

Необходимо разработать алгоритм, позволяющий **отличить допустимые изображений от недопустимых**. Сложность обуславливается тем, что текст может содержаться и на допустимых фотографиях.
Пользователи загружают картинки в раздел "Отзывы". В ряде случаев недобросовестные пользователи используют отзывы для рекламы товаров или услуг.

# 1. Формализация задачи и EDA

В рамках первой части проекта определена опасность данной проблемы для бизнеса и формализована задача:

**Для начала обсудим чем подобный спам может грозить бизнесу:**

Спам, в котором предлагается оставлять хорошие отзывы за какую-то награду, может увеличить количество некорректных отзывов, что может уменьшить лоялность как среди пользовательей, так среди продавцов, из-за чего они могут выбрать площадки конкурентов
Все виды данных спамов могут понизить качество отзывов, из-за чего покупатели не захотят прибегать к опции отзывов и выберут другую площадку.

**Формализация задачи:**

Нужно разработать алгоритм, позволяющий отличать фото отзыва, содержащего спам, от фото, несодержащего. В качестве спама различают фотографии:
1) С рекламным текстом
2) С предложением о заработке денег/вакансиях
3) С просьбой перейти в телеграм-канал
4) C никнеймами в соцсетях
5) С номерами телефонов

**EDA и трансформации**

Сначала был рассмотрен обычный датасет и с применением грейскейл. Затем пробовались визуальные филтры:

- Фильтр порогового значения
- Фильтр контуров
- Фильтр Собеля

Качества фильтров сравнивались визуально, но для проверки был взят оригинальный датасет и датасет после применения фильтра Собеля: прогнал через ResNet50, оригинальный датасет себя показал лучше, в этом мы еще раз убедимся в домашнем задании 2.

# 2. Проработка вариантов решения

На данном этапе (и последующих) в датасете присутствовало большое количество аугментированных изображений, что грозит смещеной оценки метрики при попадании аугментированных изображений в тренировачную и валидационную выборки.
Поэтому необходимо было найти аугментированные изображения.

**Поиск аугментированных изображений в датасете**

В данной работе использовался алгоритм SIFT, так как он достаточно неоптимальный и так как была выдвинута гипотеза, что аугментированные изображения располагаются в датасете преимущественно друг за другом, то изображения сравнивались с восьмью изображениями до и после (в следующих работах алгоритм сравнения улучшался). Все аугментированные изображения отправились в трейн, оставшиеся распределились между трейн и вал. Дизбаланс классов решался с помошью undersampling.

**ResNet50**

Обучил ResNet50 на оригинальном датасете и после применения фильтра Собеля, на оригинальном датасете accuracy 0.846, после фильтра - 0.674 (Для сравнения использовалась только метрика accuracy, так как далее еще будет проверка по easyOCR, да и классы сбалансированы, поэтому она имеет место быть).

**Распознавание слов на изображениях с помощью EasyOcr**

К оригинальному датасету и датасету после фильтра Собеля применялся EayOCR, для считывания слов с изображений. При визуальном сопоставлении списка слов и изображений, easyocr гораздо лучше справился на оригинальном датасете (что неудивительно, так как он наверняка обучался на данных без применения таких фильтров).

**Определение спама по заданным словам с изображения**

В качестве первой наивной модели классификации текстов была рассмотрена модель, которая классифицирует изображений как спам, при наличии слов из списка "плохих слов". Список "плохих слов" был составлен мной при просмотре большого количества спам изображений датасета, в него входят: **"платят", "телег", "тг", "деньги", "работ", "подработк", "скрин",
"tg", "@", "teleg", "bot", "оплат", "пиши", "зарабатыв", "денюж", "вложен", 'ищи'**. Данная модель на оригинальном датасете показала accuracy 0.923, после применения фильтра Собеля - 0.810, поэтому в дальнейших работах использовался оригинальный датасет, так как фильтр Собеля не показал себя ни одной из модели.

**Подведем полный итог**

- Я протестировал 4 решения: ResNet и easyOCR с предположительными спамовыми словами, каждая модель была проверена на оригинальном датасете и на датасете после фильтра Собеля
- 1) ResNet - обычный классификатор, неудивительно, что он показал не очень хороший результат (Оригинальный датасет - 0.846, Фильтр Собеля - 0.674), однако у меня была гипотеза, что контрастность после фильтра Собеля сделает из ResNet неплохой классификатор и для нашего случая, однако гипотеза разбилась вдребезги
  2) Модель easyOCR с предположительными спамовыми словами учитывает специфику задачи, в этом его большой плюс и результаты это подтверждают (Оригинальный датасет - 0.92, Фильтр Собеля - 0.81), однако спамовые слова лишь предположение, поэтому дальше использовались другие NLP модели
- С помощью алгоритма SIFT были проверены изображения на аугментации, тем самым удалось выявить дупликаты, кроп и другие аугментации на картинках, в дальнейших работах данный алгоритм будет улучшен, а затем и вовсе заменен
- После этого, все картинки, у которых есть "близнецы" с аугментациями были отправлены в трейн, дабы исключить пересечение с валидационной выборкой и научиться распознавать спам на изображениях под разными углами (буквально), затем разделилось на трейн и вал с проверками на пересечения
